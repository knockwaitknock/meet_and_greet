function matrixToArray(e) {
    return e.substr(7, e.length - 8).split(", ")
}
function easeOutBack(e, t, n, i, a) {
    return void 0 == a && (a = 1.70158), n * ((e = e / i - 1) * e * ((a + 1) * e + a) + 1) + t
}
function slideout(e, t) {
    function n() {
        if (v = Date.now() - d, h)$(".itemslide_slideoutwrap").translate3d(0, s - easeOutBack(v, 0, s - r, 250, 0)), e.savedSlide.css("opacity", c - easeOutBack(v, 0, c - 0, 250, 0) * (u ? -1 : 1)); else {
            if (u)return $(".itemslide_slideoutwrap").children().unwrap(), $(".itemslide_move").children().unwrap(), isExplorer && e.children().css("height", ""), e.end_animation = !0, void(v = 0);
            $(".itemslide_move").translate3d(0 - easeOutBack(v - 250, 0, 0 + e.savedSlide.width(), 125, 0) * (g ? -1 : 1))
        }
        return 1 == p && ($(".itemslide_slideoutwrap").children().unwrap(), e.savedSlideIndex == e.data("vars").currentIndex && $(".itemslide_move").children(":nth-child(1)").attr("id", "active"), e.savedSlideIndex != e.children().length - 1 || g || e.savedSlideIndex != e.data("vars").currentIndex || (t.duration = 200, e.gotoSlide(e.children().length - 2)), 0 == e.savedSlideIndex && 0 != e.data("vars").currentIndex && (v = 500), p = -1), v >= 250 && (h = !1, -1 != p && (p = 1), v >= 375) ? ($(".itemslide_move").children().unwrap(), e.removeSlide(i.index()), (0 == e.savedSlideIndex && 0 != e.data("vars").currentIndex || g) && e.gotoWithoutAnimation(e.data("vars").currentIndex - 1), t.duration = o, v = 0, void(e.end_animation = !0)) : void(l = requestAnimationFrame(n))
    }

    var i, a, r = -400, d = Date.now(), s = 0, l = 0, o = 0, c = 0;
    e.end_animation = !0;
    var u = !1;
    e.swipeOut = function () {
        s = $(".itemslide_slideoutwrap").translate3d().y, a = 0 > s, r = a ? -400 : 400, Math.abs(0 - s) < 50 ? (u = !0, r = 0) : (u = !1, e.trigger("swipeout")), p = 0, o = t.duration, i = e.savedSlide, d = Date.now(), c = e.savedSlide.css("opacity"), e.savedSlideIndex < e.data("vars").currentIndex ? (g = !0, e.children(":nth-child(-n+" + (e.savedSlideIndex + 1) + ")").wrapAll("<div class='itemslide_move' />")) : (g = !1, e.children(":nth-child(n+" + (e.savedSlideIndex + 2) + ")").wrapAll("<div class='itemslide_move' />")), h = !0, e.end_animation = !1, l = requestAnimationFrame(n)
    };
    var h = !0, v = 0, p = 0, g = !1
}
var isExplorer = !1 || !!document.documentMode;
$(function () {
    "use strict";
    $.fn.initslide = function (e) {
        alert("Please do not use .initslide() as its deprecated - use .itemslide() instead"), this.itemslide(e)
    }, $.fn.itemslide = function (e) {
        function t(e) {
            "touchmove" == e.type ? (x = null == $.fn.jquery ? e.changedTouches[0] : e.originalEvent.touches[0] || e.originalEvent.changedTouches[0], Math.abs(x.pageX - I) > 10 && (y = 1), y && e.preventDefault()) : (x = e, e.preventDefault()), u = -(x.pageX - I) > 0 ? 1 : -1, r() ? A && (D = x.pageX, A = 0) : (A || (m.currentLandPos = m.translate3d().x, I = x.pageX), A = 1), 1 == M && (isExplorer && m.children().css("height", m.data("vars").slideHeight), m.savedSlide.wrapAll("<div class='itemslide_slideoutwrap' />"), M = -1), Math.abs(x.pageX - I) > 6 && (!p && m.end_animation && (g = !0), cancelAnimationFrame(c)), Math.abs(x.pageY - S) > 6 && !g && m.end_animation && (p = !0), g ? (p = !1, m.translate3d((0 == A ? D - I + (x.pageX - D) / 4 : x.pageX - I) + m.currentLandPos), m.trigger("changePos"), m.trigger("pan")) : p && f.swipe_out && (e.preventDefault(), $(".itemslide_slideoutwrap").translate3d(0, x.pageY - S), -1 != M && (M = 1))
        }

        function n(e) {
            m.children(":nth-child(" + (m.data("vars").currentIndex + 1 || 0) + ")").attr("id", ""), m.children(":nth-child(" + (e + 1 || 0) + ")").attr("id", "active"), e != f.currentIndex && (m.data("vars").currentIndex = e, m.trigger("changeActiveIndex"))
        }

        function i(e) {
            for (var t = 0; t < m.children("li").length; t++)if (m.children().cwidth() * t + m.children().cwidth() / 2 - m.children().cwidth() * f.pan_threshold * u - a(0) > e)return f.one_item ? t != m.data("vars").currentIndex ? m.data("vars").currentIndex + 1 * u : m.data("vars").currentIndex : t;
            return f.one_item ? m.data("vars").currentIndex + 1 : m.children("li").length - 1
        }

        function a(e) {
            return-(e * m.children().cwidth() - (m.parent().cwidth() - l - m.children().cwidth()) / 2)
        }

        function r() {
            return Math.floor(m.translate3d().x) > a(0) && -1 == u || Math.ceil(m.translate3d().x) < a(m.children("li").length - 1) && 1 == u
        }

        function d(e) {
            e >= m.children("li").length - 1 || 0 >= e ? (h = !0, e = Math.min(Math.max(e, 0), m.children("li").length - 1)) : h = !1, n(e), F = Math.max(f.duration - 1920 / $(window).width() * Math.abs(m.data("vars").velocity) * 9 * (f.duration / 230) - (r() ? v / 15 : 0) * (f.duration / 230), 50), X = h ? 250 * Math.abs(m.data("vars").velocity) / $(window).width() : 0, o = m.translate3d().x, m.currentLandPos = a(e), cancelAnimationFrame(c), P = Date.now(), c = requestAnimationFrame(s)
        }

        function s() {
            var e = Date.now() - P;
            return m.trigger("changePos"), m.translate3d(o - easeOutBack(e, 0, o - m.currentLandPos, F, X)), e >= F ? void m.translate3d(m.currentLandPos) : void(c = requestAnimationFrame(s))
        }

        var l = 0, o = 0, c = 0, u = 0, h = !1, v = 0, p = !1, g = !1, m = $(this), w = {duration: 350, swipe_sensitivity: 150, disable_slide: !1, disable_scroll: !1, start: 0, one_item: !1, pan_threshold: .3, disable_autowidth: !1, swipe_out: !1}, f = $.extend({}, w, e);
        this.data("vars", {currentIndex: 0, disable_autowidth: f.disable_autowidth, velocity: 0, slideHeight: m.children().height()}), m.end_animation = !0, f.swipe_out && slideout(m, f), l = parseInt(m.css("left").replace("px", "")), m.css({"touch-action": "pan-y", "-webkit-user-select": "none", "-webkit-touch-callout": "none", "-webkit-user-drag": "none", "-webkit-tap-highlight-color": "rgba(0, 0, 0, 0)"}), f.disable_autowidth || m.css("width", m.children("li").length * m.children().cwidth() + 10), m.translate3d(0), d(f.start);
        var x, _ = !1, I = 0, S = 0, y = !1, b = 0;
        m.savedSlideIndex = 0, m.on("mousedown touchstart", "li", function (e) {
            if (!f.disable_slide) {
                if (x = "touchstart" == e.type ? null == $.fn.jquery ? e.changedTouches[0] : e.originalEvent.touches[0] || e.originalEvent.changedTouches[0] : e, !m.end_animation)return;
                b = Date.now(), _ = 1, y = 0, I = x.pageX, S = x.pageY, p = !1, g = !1, m.savedSlide = $(this), m.savedSlideIndex = m.savedSlide.index(), M = 0, $(window).on("mousemove touchmove", t), window.getSelection ? window.getSelection().empty ? window.getSelection().empty() : window.getSelection().removeAllRanges && window.getSelection().removeAllRanges() : document.selection && document.selection.empty()
            }
        });
        var A = !0, D = 0, M = 0;
        $(window).on("mouseup touchend", function (e) {
            if (!f.disable_slide && _)if (x = "touchend" == e.type ? null == $.fn.jquery ? e.changedTouches[0] : e.originalEvent.touches[0] || e.originalEvent.changedTouches[0] : e, _ = !1, $(window).off("mousemove touchmove"), p && f.swipe_out)m.swipeOut(); else if (m.end_animation) {
                var t = Date.now() - b;
                m.data("vars").velocity = -(x.pageX - I) / t, u = m.data("vars").velocity > 0 ? 1 : -1, v = (x.pageX - I) * u * -1, (x.pageX - I) * u < -6 ? d(i(m.data("vars").velocity * f.swipe_sensitivity - m.translate3d().x)) : m.savedSlide.index() != m.data("vars").currentIndex && (e.preventDefault(), d(m.savedSlide.index()))
            }
        });
        try {
            m.mousewheel(function (e) {
                if (!f.disable_scroll) {
                    m.data("vars").velocity = 0;
                    var t = m.data("vars").currentIndex - e.deltaY;
                    if (t >= m.children("li").length || 0 > t)return;
                    d(t), e.preventDefault()
                }
            })
        } catch (E) {
        }
        m.on("gotoSlide", function (e, t) {
            d(t)
        });
        var X = 0, F = f.duration, P = Date.now();
        m.gotoWithoutAnimation = function (e) {
            m.data("vars").currentIndex = e, m.currentLandPos = a(e), m.translate3d(a(e))
        }
    }, $.fn.gotoSlide = function (e) {
        this.trigger("gotoSlide", e)
//    }, $.fn.next = function () {
//        this.gotoSlide(this.data("vars").currentIndex + 1)
    }, $.fn.previous = function () {
        this.gotoSlide(this.data("vars").currentIndex - 1)
    }, $.fn.reload = function () {
        this.data("vars").disable_autowidth || this.css("width", this.children("li").length * this.children().cwidth() + 10), this.data("vars").slideHeight = this.children().height(), this.data("vars").velocity = 0, this.gotoSlide(this.data("vars").currentIndex)
    }, $.fn.addSlide = function (e) {
        this.append("<li>" + e + "</li>"), this.reload()
    }, $.fn.removeSlide = function (e) {
        this.children(":nth-child(" + (e + 1 || 0) + ")").remove()
    }, $.fn.getActiveIndex = function () {
        return this.data("vars").currentIndex
    }, $.fn.getCurrentPos = function () {
        return this.translate3d().x
    }, $.fn.translate3d = function (e, t) {
        if (null == e) {
            var n = matrixToArray(this.css("transform"));
            if (null != $.fn.jquery)return{x: parseFloat(isExplorer ? n[12] : n[4]), y: parseFloat(isExplorer ? n[13] : n[5])};
            var i = this.css("transform").replace("translate3d", "").replace("(", "").replace(")", "").replace(" ", "").replace("px", "").split(",");
            return{x: parseFloat(i[0]), y: parseFloat(i[1])}
        }
        this.css("transform", "translate3d(" + e + "px," + (t || 0) + "px, 0px)")
    }, $.fn.cwidth = function () {
        return parseInt(this.css("width").replace("px", ""))
    }
});